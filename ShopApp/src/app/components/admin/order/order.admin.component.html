<div class="container-fluid">
  <h1>Orders Admin Page</h1>

  <!-- Search bar -->
  <div class="row mb-3">
    <div class="col-md-8">
      <input type="text" class="form-control search-input" placeholder="Tìm đơn hàng" [(ngModel)]="keyword">
    </div>
    <div class="col-md-4">
      <button class="btn btn-primary" (click)="searchOrders()">Tìm kiếm</button>
    </div>
  </div>

  <!-- Orders table -->
  <table class="table table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>Full Name</th>
        <th>Email</th>
        <th>Phone Number</th>
        <th>Address</th>
        <th>Note</th>
        <th>Order Date</th>
        <th>Status</th>
        <th>Total Money</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let order of orders; index as i">
        <td>{{ i + 1 }}</td>
        <td>{{ order.fullname }}</td>
        <td>{{ order.email }}</td>
        <td>{{ order.phone_number }}</td>
        <td>{{ order.address }}</td>
        <td>{{ order.note }}</td>
        <td>{{ order.order_date | date: 'dd/MM/yyyy' }}</td>
        <td [ngClass]="{
          'text-warning': order.status === 'pending',
          'text-primary': order.status === 'processing',
          'text-info': order.status === 'shipped',
          'text-success': order.status === 'delivered',
          'text-danger': order.status === 'cancelled'
        }">{{ order.status.at(0)?.toUpperCase() + order.status.substring(1) }}</td>
        <td>{{ order.total_money| currency:'VND' }}</td>
        <td>
          <div style="display: flex; gap: 10px;">
            <button (click)="viewDetails(order)" class="btn btn-primary" title="View Details">
              <i class="fa fa-eye"></i>
            </button>
            <button (click)="openDeleteModal(order)" class="btn btn-danger" title="Delete">
              <i class="fa fa-trash"></i>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Pagination -->
  <div class="d-flex justify-content-end">
    <ngb-pagination [collectionSize]="totalPages * itemsPerPage" [(page)]="currentPage" [pageSize]="itemsPerPage"
      (pageChange)="onPageChange($event)">
    </ngb-pagination>
  </div>

  <!-- Delete Confirmation Modal -->
  <ng-template #deleteModal let-modal>
    <div class="modal-header">
      <h4 class="modal-title">Confirm Delete</h4>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to delete this order?</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-danger" (click)="confirmDelete()">Delete</button>
      <button type="button" class="btn btn-secondary" (click)="modal.close('Close click')">Cancel</button>
    </div>
  </ng-template>
</div>
